# === GESTORE RETI ROFI ===

# Stato attuale del Wi-Fi e connessione
wifi_enabled=$(nmcli radio wifi)
current_connection=$(nmcli -t -f NAME,DEVICE connection show --active | grep ":w" | cut -d: -f1)
wifi_status=$( [ -n "$current_connection" ] && echo "connected -> $current_connection" || echo "disconnected" )

# Mostra il menu
choice=$(echo -e "Wi-Fi: $wifi_enabled\nStatus: $wifi_status\n--------------------\nShow available networks\nOpen Network Manager\n--------------------\nExit" | rofi -dmenu -i -p "Gestione rete")

# Gestione scelte
case "$choice" in
    "Wi-Fi: enabled")
        nmcli radio wifi off
        ;;
    "Wi-Fi: disabled")
        nmcli radio wifi on
        exec "$HOME/.config/rofi/Network/rofi-network" -config ~/.config/rofi/config.rasi
        ;;
    "Status: connected"*)
        confirm=$(echo -e "No\nYes" | rofi -dmenu -i -p "Disconnettersi da $current_connection?")
        if [[ "$confirm" == "Yes" ]]; then
            nmcli connection down "$current_connection"
        fi
        exec "$HOME/.config/rofi/Network/rofi-network" -config ~/.config/rofi/config.rasi
        ;;
    "Open Network Manager")
        kitty -e nmtui
        ;;
    "Show available networks")
        notify-send "Wi-Fi" "Scansione in corso..."
        exec "$HOME/.config/rofi/Network/rofi-show-network" -config ~/.config/rofi/config.rasi
        ;;
    *)
        exit 0
        ;;
esac