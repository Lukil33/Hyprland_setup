#!/usr/bin/env bash

# Stato attuale del Wi-Fi e connessione
wifi_enabled=$(nmcli radio wifi)
current_connection=$(nmcli -t -f NAME,DEVICE connection show --active | grep ":w" | cut -d: -f1)
wifi_status=$( [ -n "$current_connection" ] && echo "Connected -> $current_connection" || echo "Disconnected" )

# Mostra il menu
choice=$(echo -e "Wi-Fi: $wifi_enabled\nStatus: $wifi_status\n--------------------\nShow available networks\nOpen Network Manager\n--------------------\nExit" | rofi -dmenu -i -p "Gestione rete")

# Gestione scelte
case "$choice" in
    "Wi-Fi: enabled")
        nmcli radio wifi off
        ;;
    "Wi-Fi: disabled")
        nmcli radio wifi on
        ;;
    "Open Network Manager")
        kitty -e nmtui
        ;;
    "Show available networks")
        notify-send "Wi-Fi" "Scansione in corso..."
        $HOME/.config/rofi/Network/rofi-show-network
        ;;
    *)
        exit 0
        ;;
esac
